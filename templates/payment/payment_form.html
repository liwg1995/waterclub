{% extends 'base.html' %}

{% block title %}支付 - 水立方舞蹈工作室{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <div class="bg-white rounded-lg shadow-lg p-8">
        <h1 class="text-3xl font-bold mb-8 text-gray-900">课程报名支付</h1>
        
        <!-- 订单信息 -->
        <div class="mb-8 pb-8 border-b border-gray-200">
            <h2 class="text-xl font-bold mb-4">订单信息</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <p class="text-gray-600 text-sm">学员姓名</p>
                    <p class="text-lg font-semibold">{{ student_name }}</p>
                </div>
                <div>
                    <p class="text-gray-600 text-sm">课程名称</p>
                    <p class="text-lg font-semibold">{{ course_name }}</p>
                </div>
                <div>
                    <p class="text-gray-600 text-sm">订单号</p>
                    <p class="text-lg font-semibold font-mono">{{ order_no }}</p>
                </div>
                <div>
                    <p class="text-gray-600 text-sm">支付金额</p>
                    <p class="text-2xl font-bold text-blue-600">¥ {{ amount }}</p>
                </div>
            </div>
        </div>
        
        <!-- 支付方式选择 -->
        <div class="mb-8">
            <h2 class="text-xl font-bold mb-4">选择支付方式</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button class="p-4 border-2 border-blue-500 rounded-lg bg-blue-50 cursor-pointer hover:bg-blue-100 transition-colors" onclick="selectPaymentMethod('alipay_web')">
                    <div class="font-bold text-blue-600 mb-2">🛒 支付宝网页支付</div>
                    <p class="text-sm text-gray-600">通过支付宝网页版进行支付</p>
                </button>
                <button class="p-4 border-2 border-gray-300 rounded-lg cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-colors" onclick="selectPaymentMethod('alipay_qr')">
                    <div class="font-bold text-gray-700 mb-2">📱 支付宝当面付</div>
                    <p class="text-sm text-gray-600">扫描二维码进行支付</p>
                </button>
                <button class="p-4 border-2 border-gray-300 rounded-lg cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-colors" onclick="selectPaymentMethod('wechat_pay')">
                    <div class="font-bold text-gray-700 mb-2">💳 微信支付</div>
                    <p class="text-sm text-gray-600">通过微信扫码或APP支付</p>
                </button>
                <button class="p-4 border-2 border-gray-300 rounded-lg cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-colors" onclick="selectPaymentMethod('hupi_pay')">
                    <div class="font-bold text-gray-700 mb-2">🔐 虎皮椒支付</div>
                    <p class="text-sm text-gray-600">快速安全的第三方支付</p>
                </button>
            </div>
        </div>
        
        <!-- 支付说明 -->
        <div class="mb-8 bg-blue-50 p-4 rounded-lg">
            <h3 class="font-bold text-blue-900 mb-2">💡 支付提示</h3>
            <ul class="text-sm text-blue-800 space-y-1">
                <li>✓ 请选择您熟悉的支付方式进行支付</li>
                <li>✓ 支付完成后，订单状态会自动更新</li>
                <li>✓ 如有问题，请拨打客服热线：400-123-4567</li>
            </ul>
        </div>
        
        <!-- 操作按钮 -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <button id="payBtn" class="bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-3 rounded-lg font-bold hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed" onclick="submitPayment()">
                立即支付
            </button>
            <a href="{% url 'cms:contact' %}" class="border-2 border-blue-500 text-blue-600 px-8 py-3 rounded-lg font-bold hover:bg-blue-50 transition-colors text-center">
                返回
            </a>
        </div>
    </div>
</div>

<script>
    let selectedMethod = 'alipay_web';
    
    function selectPaymentMethod(method) {
        selectedMethod = method;
        // 更新UI显示选中状态
        document.querySelectorAll('button[onclick^="selectPaymentMethod"]').forEach(btn => {
            btn.classList.remove('border-blue-500', 'bg-blue-50');
            btn.classList.add('border-gray-300');
        });
        event.target.closest('button').classList.remove('border-gray-300');
        event.target.closest('button').classList.add('border-blue-500', 'bg-blue-50');
    }
    
    function submitPayment() {
        const btn = document.getElementById('payBtn');
        btn.disabled = true;
        btn.textContent = '支付处理中...';
        
        // 实际支付处理（这里简化为直接标记为支付成功）
        // 在生产环境中，需要调用真实的支付API
        setTimeout(() => {
            window.location.href = '/api/payment/success/?order_no={{ order_no }}';
        }, 2000);
    }
</script>
{% endblock %}
